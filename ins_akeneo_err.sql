INSERT INTO loading.akeneo_error (product_hash,mfg_id,error_msg,sku,categories,enabled,family,groups,atero_cat2,avalara_freight_code,avalara_tax_code,base_name,brochure,brochure_2,brochure_3,brochure_4,brochure_5,brochure_6,brochure_7,brochure_8,brochure_9,brochure_10,cad_file,discontinued,discontinued_at,epn_accessory_groups,epn_accessory_products,epn_mfg_id,epn_option_groups,epn_option_products,free_accessory,freight_class,height,height_unit,image_secondary_1,image_secondary_2,image_secondary_3,image_secondary_4,image_secondary_5,item_type,key_features,key_utility_information,lead_time,lead_time_unit,length,length_unit,manual,manual_2,manual_3,manual_4,manual_5,manual_6,manual_7,manual_8,manual_9,manual_10,manufacturer_abbreviation,model_no,name,PACK_groups,PACK_products,per_case,price_EUR,price_USD,price_by_qty,primary_image,product_family,selling_unit,shipping_weight,shipping_weight_unit,spec_sheet_file,spec_sheet_file_2,spec_sheet_file_3,spec_sheet_file_4,spec_sheet_file_5,spec_sheet_file_6,spec_sheet_file_7,spec_sheet_file_8,spec_sheet_file_9,spec_sheet_file_10,SUBSTITUTION_groups,SUBSTITUTION_products,uom_measurement,upc,UPSELL_groups,UPSELL_products,variant_axis_1,variant_axis_1_value,variant_axis_2,variant_axis_2_value,variant_axis_3,variant_axis_3_value,variant_axis_4,variant_axis_4_value,variant_axis_5,variant_axis_5_value,variant_axis_6,variant_axis_6_value,variant_axis_7,variant_axis_7_value,variant_axis_8,variant_axis_8_value,variant_axis_9,variant_axis_9_value,variant_axis_10,variant_axis_10_value,variant_base_prod,video_1,video_2,video_3,video_4,video_5,video_url_1,video_url_2,video_url_3,video_url_4,video_url_5,warranty,warranty_2,warranty_3,warranty_4,warranty_5,warranty_6,warranty_7,warranty_8,warranty_9,warranty_10,width,width_unit,X_SELL_groups,X_SELL_products,created_at)

SELECT product_hash,mfg_id,'Missing MFR',sku,categories,enabled,family,groups,atero_cat2,avalara_freight_code,avalara_tax_code,base_name,brochure,brochure_2,brochure_3,brochure_4,brochure_5,brochure_6,brochure_7,brochure_8,brochure_9,brochure_10,cad_file,discontinued,discontinued_at,epn_accessory_groups,epn_accessory_products,epn_mfg_id,epn_option_groups,epn_option_products,free_accessory,freight_class,height,height_unit,image_secondary_1,image_secondary_2,image_secondary_3,image_secondary_4,image_secondary_5,item_type,key_features,key_utility_information,lead_time,lead_time_unit,length,length_unit,manual,manual_2,manual_3,manual_4,manual_5,manual_6,manual_7,manual_8,manual_9,manual_10,manufacturer_abbreviation,model_no,name,PACK_groups,PACK_products,per_case,price_EUR,price_USD,price_by_qty,primary_image,product_family,selling_unit,shipping_weight,shipping_weight_unit,spec_sheet_file,spec_sheet_file_2,spec_sheet_file_3,spec_sheet_file_4,spec_sheet_file_5,spec_sheet_file_6,spec_sheet_file_7,spec_sheet_file_8,spec_sheet_file_9,spec_sheet_file_10,SUBSTITUTION_groups,SUBSTITUTION_products,uom_measurement,upc,UPSELL_groups,UPSELL_products,variant_axis_1,variant_axis_1_value,variant_axis_2,variant_axis_2_value,variant_axis_3,variant_axis_3_value,variant_axis_4,variant_axis_4_value,variant_axis_5,variant_axis_5_value,variant_axis_6,variant_axis_6_value,variant_axis_7,variant_axis_7_value,variant_axis_8,variant_axis_8_value,variant_axis_9,variant_axis_9_value,variant_axis_10,variant_axis_10_value,variant_base_prod,video_1,video_2,video_3,video_4,video_5,video_url_1,video_url_2,video_url_3,video_url_4,video_url_5,warranty,warranty_2,warranty_3,warranty_4,warranty_5,warranty_6,warranty_7,warranty_8,warranty_9,warranty_10,width,width_unit,X_SELL_groups,X_SELL_products,current_timestamp
FROM loading.akeneo a WHERE a.product_hash is NULL;

--Delete records from akeneo that have no MFG ID
DELETE FROM loading.akeneo WHERE product_hash is NULL;

